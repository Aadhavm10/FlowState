commands:
  01_install_python311:
    command: |
      # Install Python 3.11 (yt-dlp requires 3.10+)
      sudo dnf install -y python3.11 python3.11-pip
    ignoreErrors: false
  02_install_ffmpeg:
    command: |
      # Install ffmpeg for audio processing (needed for MP3 conversion and trimming)
      sudo dnf install -y ffmpeg
    ignoreErrors: false
  03_set_python_alternative:
    command: |
      # Set python3.11 as the default python3 (optional, for safety use python3.11 explicitly)
      sudo alternatives --install /usr/bin/python3 python3 /usr/bin/python3.11 1
    ignoreErrors: true
  04_install_ytdlp:
    command: |
      # Install/upgrade yt-dlp using Python 3.11
      sudo python3.11 -m pip install --upgrade yt-dlp
    ignoreErrors: false
  05_create_cache_dir:
    command: |
      # Create cache directory for 30s previews
      mkdir -p /var/app/current/cache/previews
      chmod 755 /var/app/current/cache/previews
    ignoreErrors: true
  06_verify_installation:
    command: |
      # Verify installations
      echo "Python version: $(python3.11 --version)"
      echo "yt-dlp version: $(python3.11 -m yt_dlp --version)"
      echo "ffmpeg version: $(ffmpeg -version | head -1)"
    ignoreErrors: true
